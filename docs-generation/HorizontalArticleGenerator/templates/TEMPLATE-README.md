# Horizontal Service Template - Variables Documentation

This document describes all variables used in the `horizontal-service-template.hbs` template. This template is designed for generating horizontal "how-to" articles for Azure services with Azure MCP Server integration.

## Overview

The template uses two types of variables:
1. **Static variables** - Extracted from CLI output and configuration files
2. **AI-generated variables** - Content generated by AI using prompts (prefixed with `genai-`)

## Static Variables

These variables are populated from CLI output and configuration files before AI generation.

| Variable | Type | Description | Example |
|----------|------|-------------|---------|
| `serviceBrandName` | string | Official Azure service brand name | "Azure Key Vault" |
| `serviceIdentifier` | string | Service identifier for metadata | "keyvault" |
| `generatedAt` | string | ISO 8601 timestamp of generation | "2024-01-29T12:00:00Z" |
| `version` | string | Azure MCP Server version | "1.0.0" |
| `toolsReferenceLink` | string | Relative path to tools reference | "../tools/keyvault.md" |
| `tools` | array | Array of tool objects (see below) | - |

### Tool Object Structure

Each tool in the `tools` array contains:

| Field | Type | Description |
|-------|------|-------------|
| `command` | string | Full MCP command name |
| `moreInfoLink` | string | Link to parameter reference |
| `genai-shortDescription` | string | AI-generated concise description (10-15 words) |

## AI-Generated Variables (genai- prefix)

These variables must be generated by AI based on service analysis and official Azure documentation.

### Core Service Description

#### `genai-serviceShortDescription`
- **Type:** string
- **Description:** Brief 5-10 word description of what the service manages or provides
- **Example:** "provides secure storage for secrets, keys, and certificates"
- **Used in:** Article title section

#### `genai-primaryInteraction`
- **Type:** string
- **Description:** Primary way users interact with the service via MCP (verb phrase)
- **Example:** "manage secrets, keys, and certificates"
- **Used in:** Article introduction
- **NEW VARIABLE** (not in original template)

#### `genai-serviceFullDescription`
- **Type:** string (paragraph)
- **Description:** Comprehensive 2-4 sentence explanation of the service, its purpose, and value proposition
- **Example:** "Azure Key Vault is a cloud service for securely storing and accessing secrets, encryption keys, and certificates. It helps you control access to passwords, API keys, and other secrets your applications need. Key Vault eliminates the need to store sensitive information in code and provides centralized secret management with audit logging."
- **Used in:** "What is [Service]?" section
- **NEW VARIABLE** (not in original template)

#### `genai-coreCapabilities`
- **Type:** array of objects
- **Description:** List of 3-5 core service capabilities with names and descriptions
- **Structure:** 
  ```json
  [
    {
      "name": "Secret management",
      "description": "Securely store and tightly control access to tokens, passwords, and API keys"
    }
  ]
  ```
- **Used in:** "What is [Service]?" section
- **NEW VARIABLE** (not in original template)

#### `genai-integrationBenefit`
- **Type:** string
- **Description:** Concise statement of benefit from MCP integration (1 sentence)
- **Example:** "manage your Key Vault secrets through conversational AI without writing code"
- **Used in:** "What is [Service]?" section
- **NEW VARIABLE** (not in original template)

### Prerequisites

#### `genai-serviceSpecificPrerequisites`
- **Type:** array of objects
- **Description:** Service-specific prerequisites (beyond standard Azure requirements)
- **Structure:**
  ```json
  [
    {
      "title": "Existing Key Vault",
      "description": "A Key Vault resource must be created before you can manage secrets"
    }
  ]
  ```
- **Used in:** Prerequisites section
- **Existing in original template, but still required**

#### `genai-author`
- **Type:** string (optional)
- **Description:** Article author name for metadata
- **Example:** "John Doe"
- **Used in:** YAML front matter
- **NEW VARIABLE** (not in original template)

#### `genai-msAuthor`
- **Type:** string (optional)
- **Description:** Microsoft author alias for metadata
- **Example:** "johndoe"
- **Used in:** YAML front matter
- **NEW VARIABLE** (not in original template)

### How It Works

#### `genai-workflowSteps`
- **Type:** array of strings
- **Description:** Step-by-step explanation of how MCP Server processes requests (4-6 steps)
- **Example:**
  ```json
  [
    "Your AI assistant receives your natural language request",
    "The request is translated into an MCP tool call with parameters",
    "Azure MCP Server authenticates using your Azure credentials",
    "The operation is executed on Key Vault",
    "Results are formatted and returned to your AI assistant"
  ]
  ```
- **Used in:** "How it works" section
- **Default provided if not specified**
- **NEW VARIABLE** (not in original template)

### Setup and Configuration

#### `genai-setupSteps`
- **Type:** array of objects
- **Description:** Step-by-step setup instructions for configuring the service with MCP
- **Structure:**
  ```json
  [
    {
      "title": "Create a Key Vault",
      "content": "You need an existing Key Vault resource. Create one in the Azure portal or use Azure CLI.",
      "example": "az keyvault create --name my-keyvault --resource-group my-rg --location eastus",
      "exampleLanguage": "bash"
    }
  ]
  ```
- **Fields:**
  - `title` (required): Step title
  - `content` (required): Step instructions
  - `example` (optional): Code/command example
  - `exampleLanguage` (optional): Language for syntax highlighting
- **Used in:** "Set up Azure MCP Server" section
- **NEW VARIABLE** (not in original template)

### Operations/Tools

#### `genai-operationCategories`
- **Type:** array of objects
- **Description:** Tools organized into logical categories for better navigation
- **Structure:**
  ```json
  [
    {
      "category": "Secret Management",
      "description": "Operations for managing secrets in Key Vault",
      "tools": [
        {
          "command": "keyvault secret set",
          "moreInfoLink": "../parameters/keyvault-secret-set-parameters.md",
          "genai-shortDescription": "Store a new secret or update an existing secret value"
        }
      ]
    }
  ]
  ```
- **Used in:** "Available operations" section
- **Falls back to flat tool list if not provided**
- **NEW VARIABLE** (not in original template)

### Common Tasks

#### `genai-commonTasks`
- **Type:** array of objects
- **Description:** Practical task-oriented examples with context (3-7 tasks)
- **Structure:**
  ```json
  [
    {
      "title": "Store a database connection string",
      "description": "Securely store connection strings for your applications to retrieve at runtime.",
      "examples": [
        "Store my database connection string as a secret named 'db-connection' in Key Vault 'prod-vault'",
        "Create a new secret called 'api-key' with value 'abc123' in my Key Vault",
        "Add a secret named 'storage-key' to the vault 'app-secrets' in resource group 'production'"
      ],
      "whatHappens": "Azure MCP Server creates or updates the secret in your Key Vault with the specified value. The secret is encrypted at rest and access is logged for audit purposes.",
      "result": "The AI assistant confirms the secret was stored successfully and provides the secret version identifier."
    }
  ]
  ```
- **Fields:**
  - `title` (required): Task name
  - `description` (required): Context and use case
  - `examples` (required): Array of natural language prompts
  - `whatHappens` (optional): Process explanation
  - `result` (optional): Expected outcome
- **Used in:** "Common tasks" section
- **NEW VARIABLE** (replaces `genai-scenarios` with enhanced structure)

### Authentication and Permissions

#### `genai-permissionsTable`
- **Type:** array of objects
- **Description:** Structured table of permissions by operation type
- **Structure:**
  ```json
  [
    {
      "operationType": "Read secrets",
      "role": "Key Vault Secrets User",
      "scope": "Key Vault resource"
    },
    {
      "operationType": "Create/update secrets",
      "role": "Key Vault Secrets Officer",
      "scope": "Key Vault resource"
    }
  ]
  ```
- **Used in:** Authentication section table
- **Falls back to `genai-requiredRoles` if not provided**
- **NEW VARIABLE** (not in original template)

#### `genai-requiredRoles`
- **Type:** array of objects
- **Description:** Required Azure RBAC roles
- **Structure:**
  ```json
  [
    {
      "name": "Key Vault Secrets User",
      "purpose": "Read secret values from Key Vault"
    }
  ]
  ```
- **Used in:** Authentication section (fallback format)
- **Existing in original template**

#### `genai-authenticationMethods`
- **Type:** array of objects
- **Description:** Supported authentication methods with descriptions
- **Structure:**
  ```json
  [
    {
      "method": "Azure CLI",
      "description": "Use 'az login' to authenticate. Recommended for local development."
    },
    {
      "method": "Managed Identity",
      "description": "Automatically authenticate when running in Azure services. Best for production."
    }
  ]
  ```
- **Used in:** Authentication methods subsection
- **NEW VARIABLE** (not in original template)

#### `genai-authenticationNotes`
- **Type:** string (optional)
- **Description:** Additional authentication guidance specific to the service
- **Example:** "Key Vault uses both Azure RBAC and access policies. Ensure RBAC is enabled on your vault for MCP Server to work correctly."
- **Used in:** Authentication section
- **Existing in original template**

### Best Practices

#### `genai-bestPracticesStructured`
- **Type:** object
- **Description:** Best practices organized by Azure Well-Architected Framework pillars
- **Structure:**
  ```json
  {
    "security": [
      "Use managed identities instead of service principals when possible",
      "Enable soft delete and purge protection on Key Vaults",
      "Implement network restrictions using firewalls and virtual networks"
    ],
    "performance": [
      "Cache secrets locally to reduce Key Vault calls",
      "Use Key Vault references in App Service for automatic secret updates"
    ],
    "costOptimization": [
      "Monitor Key Vault transaction costs for high-volume applications",
      "Consider the Standard tier for most production workloads"
    ],
    "reliability": [
      "Implement retry logic with exponential backoff",
      "Use geo-redundant Key Vaults for critical secrets"
    ],
    "operational": [
      "Enable diagnostic logging for audit trails",
      "Set up alerts for failed authentication attempts",
      "Use descriptive secret names and include metadata"
    ]
  }
  ```
- **Categories:**
  - `security` (required)
  - `performance` (optional)
  - `costOptimization` (optional)
  - `reliability` (optional)
  - `operational` (optional)
- **Used in:** Best practices section with category headings
- **Falls back to `genai-bestPractices` if not provided**
- **NEW VARIABLE** (structured version of existing variable)

#### `genai-bestPractices`
- **Type:** array of objects
- **Description:** Best practices as flat list (fallback format)
- **Structure:**
  ```json
  [
    {
      "title": "Use managed identities",
      "description": "Avoid storing credentials by using Azure managed identities"
    }
  ]
  ```
- **Used in:** Best practices section (fallback)
- **Existing in original template**

### Troubleshooting

#### `genai-troubleshootingIssues`
- **Type:** array of objects
- **Description:** Common issues with structured symptoms/cause/resolution
- **Structure:**
  ```json
  [
    {
      "title": "Access denied error",
      "symptoms": "You receive 'Forbidden' or 'Access denied' errors when trying to access secrets",
      "cause": "Your Azure identity lacks the necessary permissions on the Key Vault",
      "resolution": "Assign the 'Key Vault Secrets User' role to your identity. Use: az role assignment create --role 'Key Vault Secrets User' --assignee <your-object-id> --scope <key-vault-id>"
    }
  ]
  ```
- **Fields:**
  - `title` (required): Issue name
  - `symptoms` (optional): What users observe
  - `cause` (optional): Why it happens
  - `resolution` (required): How to fix
- **Used in:** Troubleshooting section with structured format
- **Falls back to `genai-commonIssues` if not provided**
- **NEW VARIABLE** (enhanced structure)

#### `genai-supportLinks`
- **Type:** array of objects
- **Description:** Additional support resources
- **Structure:**
  ```json
  [
    {
      "title": "Key Vault troubleshooting guide",
      "url": "https://learn.microsoft.com/azure/key-vault/general/troubleshooting"
    }
  ]
  ```
- **Used in:** Troubleshooting "Get support" subsection
- **NEW VARIABLE** (not in original template)

#### `genai-commonIssues`
- **Type:** array of objects
- **Description:** Common issues in simpler format (fallback)
- **Structure:**
  ```json
  [
    {
      "title": "Issue name",
      "description": "Issue explanation",
      "resolution": "How to fix"
    }
  ]
  ```
- **Used in:** Troubleshooting section (fallback)
- **Existing in original template**

### Next Steps

#### `genai-nextSteps`
- **Type:** array of objects
- **Description:** Forward-looking resources and next actions
- **Structure:**
  ```json
  [
    {
      "title": "Automate secret rotation",
      "url": "https://learn.microsoft.com/azure/key-vault/secrets/tutorial-rotation",
      "description": "Learn how to automatically rotate secrets"
    },
    {
      "title": "Integrate with Azure Functions",
      "url": "https://learn.microsoft.com/azure/azure-functions/functions-identity-based-connections",
      "description": "Use Key Vault secrets in your serverless applications"
    }
  ]
  ```
- **Fields:**
  - `title` (required): Link text
  - `url` (required): Link destination
  - `description` (optional): Additional context
- **Used in:** "Next steps" section
- **NEW VARIABLE** (not in original template)

### Related Content

#### `genai-serviceDocLink`
- **Type:** string
- **Description:** URL to official service overview/documentation
- **Example:** "https://learn.microsoft.com/azure/key-vault/general/overview"
- **Used in:** Related content section
- **Existing in original template**

#### `genai-serviceLinks`
- **Type:** array of objects
- **Description:** Additional service-specific documentation links
- **Structure:**
  ```json
  [
    {
      "title": "Key Vault quickstart",
      "url": "https://learn.microsoft.com/azure/key-vault/secrets/quick-create-portal"
    },
    {
      "title": "Key Vault best practices",
      "url": "https://learn.microsoft.com/azure/key-vault/general/best-practices"
    }
  ]
  ```
- **Used in:** Service subsection of related content
- **NEW VARIABLE** (not in original template)

#### `genai-additionalLinks`
- **Type:** array of objects
- **Description:** General additional resources
- **Structure:**
  ```json
  [
    {
      "title": "Link title",
      "url": "https://example.com"
    }
  ]
  ```
- **Used in:** Additional resources subsection
- **Existing in original template**

#### `genai-aiAutomationLinks`
- **Type:** array of objects
- **Description:** AI and automation related resources
- **Structure:**
  ```json
  [
    {
      "title": "AI-powered Azure management",
      "url": "https://learn.microsoft.com/azure/ai/"
    }
  ]
  ```
- **Used in:** AI and automation subsection
- **NEW VARIABLE** (not in original template)

## Variable Summary by Section

### Required for All Articles
- `serviceBrandName`
- `serviceIdentifier`
- `generatedAt`
- `version`
- `toolsReferenceLink`
- `tools`
- `genai-serviceShortDescription`
- `genai-primaryInteraction`
- `genai-serviceFullDescription`
- `genai-commonTasks`

### Optional but Recommended
- `genai-coreCapabilities`
- `genai-integrationBenefit`
- `genai-serviceSpecificPrerequisites`
- `genai-operationCategories` (or use flat `tools` list)
- `genai-permissionsTable` (or `genai-requiredRoles`)
- `genai-bestPracticesStructured` (or `genai-bestPractices`)
- `genai-troubleshootingIssues` (or `genai-commonIssues`)
- `genai-serviceDocLink`

### Optional/Conditional
- `genai-author` / `genai-msAuthor` (if authoring info available)
- `genai-workflowSteps` (defaults provided)
- `genai-setupSteps` (for services needing configuration)
- `genai-authenticationMethods`
- `genai-authenticationNotes`
- `genai-supportLinks`
- `genai-nextSteps`
- `genai-serviceLinks`
- `genai-additionalLinks`
- `genai-aiAutomationLinks`

## Comparison with Original Template

### New Variables Not in Original
1. `genai-primaryInteraction` - Primary interaction method
2. `genai-serviceFullDescription` - Expanded service description
3. `genai-coreCapabilities` - Structured capability list
4. `genai-integrationBenefit` - Integration benefit statement
5. `genai-author` / `genai-msAuthor` - Author metadata
6. `genai-workflowSteps` - How it works explanation
7. `genai-setupSteps` - Setup instructions
8. `genai-operationCategories` - Categorized tools
9. `genai-commonTasks` - Enhanced scenarios with more structure
10. `genai-permissionsTable` - Structured permissions table
11. `genai-authenticationMethods` - Authentication method list
12. `genai-troubleshootingIssues` - Enhanced troubleshooting format
13. `genai-supportLinks` - Support resources
14. `genai-nextSteps` - Next steps section
15. `genai-serviceLinks` - Service-specific links
16. `genai-aiAutomationLinks` - AI/automation links
17. `genai-bestPracticesStructured` - Structured best practices

### Variables from Original Template (Still Used)
1. `genai-serviceShortDescription`
2. `genai-serviceSpecificPrerequisites`
3. `genai-requiredRoles`
4. `genai-authenticationNotes`
5. `genai-commonIssues`
6. `genai-bestPractices`
7. `genai-serviceDocLink`
8. `genai-additionalLinks`

### Variables from Original Template (Replaced/Enhanced)
1. `genai-serviceOverview` → Split into `genai-serviceFullDescription` and `genai-integrationBenefit`
2. `genai-scenarios` → Enhanced as `genai-commonTasks` with more structure
3. `genai-aiSpecificScenarios` → Can be included in `genai-commonTasks` or `genai-nextSteps`

## Usage Notes

1. **Backward Compatibility**: The template provides fallbacks for enhanced variables, so it can work with data from the original template structure.

2. **Progressive Enhancement**: Start with required variables and add optional ones to improve article quality.

3. **AI Prompt Updates**: To generate these new variables, the AI prompts must be updated to request the additional structured data.

4. **Data Plane vs Management Plane**: Variables like `genai-commonTasks` and `genai-permissionsTable` should reflect whether the service primarily operates on the data plane or management plane.

5. **Categorization**: Use `genai-operationCategories` for services with many tools (10+) to improve navigation.

6. **Well-Architected**: Use `genai-bestPracticesStructured` to align with Azure Well-Architected Framework pillars.

7. **Next Steps**: Use `genai-nextSteps` to guide readers to advanced topics and related scenarios.
